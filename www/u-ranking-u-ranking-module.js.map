{"version":3,"sources":["webpack:///./src/app/usuario/u-ranking/u-ranking.module.ts","webpack:///./src/app/usuario/u-ranking/u-ranking.page.html","webpack:///./src/app/usuario/u-ranking/u-ranking.page.scss","webpack:///./src/app/usuario/u-ranking/u-ranking.page.ts"],"names":[],"mappings":"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","file":"u-ranking-u-ranking-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { URankingPage } from './u-ranking.page';\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { setTranslateLoader } from 'src/app/app.module';\nimport { HttpClient } from '@angular/common/http';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: URankingPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes),\n    TranslateModule.forChild({\n      loader: {\n        provide: TranslateLoader,\n        useFactory: (setTranslateLoader), deps: [HttpClient]\n      }\n    })\n  ],\n  declarations: [URankingPage]\n})\nexport class URankingPageModule { }\n","module.exports = \"<ion-header no-border color=\\\"primary\\\">\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-toggle>\\n        <ion-button>\\n          <ion-icon slot=\\\"icon-only\\\" name=\\\"menu\\\"></ion-icon>\\n        </ion-button>\\n      </ion-menu-toggle>\\n    </ion-buttons>\\n    <ion-title>\\n      <span style=\\\"font-weight:normal\\\">BlueBike</span>\\n    </ion-title>\\n  </ion-toolbar>\\n  <ion-card color=\\\"primary\\\">\\n    <ion-row>\\n      <ion-col size=\\\"4\\\" style=\\\"text-align: center\\\">\\n        <ion-avatar style=\\\"background-color:var(--ion-color-primary);position:relative;top:34px\\\">\\n          <img [src]=\\\"this.urlFirst?getImagen(this.urlSecond):'../../../assets/icon/defaultAvatar.png'\\\" style=\\\"width:100px;margin-left:1.5rem\\\">\\n        </ion-avatar>\\n      </ion-col>\\n      <ion-col size=\\\"4\\\" style=\\\"text-align: center\\\">\\n        <ion-avatar style=\\\"background-color:var(--ion-color-primary);position:relative;top:5px\\\">\\n          <img [src]=\\\"this.urlSecond?getImagen(this.urlFirst):'../../../assets/icon/defaultAvatar.png'\\\" style=\\\"width:100px;margin-left:1.3rem\\\">\\n        </ion-avatar>\\n      </ion-col>\\n      <ion-col size=\\\"4\\\" style=\\\"text-align: center\\\">\\n        <ion-avatar style=\\\"background-color:var(--ion-color-primary);position:relative;top:47px\\\">\\n          <img [src]=\\\"this.urlThird?getImagen(this.urlThird):'../../../assets/icon/defaultAvatar.png'\\\" style=\\\"width:100px;margin-left:1.25rem\\\">\\n        </ion-avatar>\\n      </ion-col>\\n    </ion-row>\\n    <ion-row>\\n      <ion-col size=\\\"12\\\">\\n        <img src=\\\"../../../assets/imgs/podium.png\\\">\\n      </ion-col>\\n    </ion-row>\\n  </ion-card>\\n</ion-header>\\n<ion-content>\\n  <ion-refresher (ionRefresh)=\\\"this.updateRanking($event,true)\\\">\\n    <ion-refresher-content pullingIcon=\\\"arrow-dropdown\\\" pullingText=\\\"{{'pulltoload' | translate}}\\\" refreshingSpinner=\\\"null\\\"\\n      refreshingText=\\\"\\\">\\n      <img src=\\\"../../../assets/imgs/loading.svg\\\" style=\\\"width:48px !important;margin:auto;position:relative;top:16px\\\">\\n    </ion-refresher-content>\\n  </ion-refresher>\\n  <ion-item *ngFor=\\\"let item of listadoRanking;let i = index\\\">\\n    <ion-icon *ngIf=\\\"i<3\\\" name=\\\"medal\\\" slot=\\\"start\\\" [style.color]=\\\"i==0?'gold':(i==1?'grey':'orange')\\\"></ion-icon>\\n    <ion-icon *ngIf=\\\"i>2\\\" name=\\\"person\\\" slot=\\\"start\\\"></ion-icon>\\n    <ion-avatar slot=\\\"end\\\" style=\\\"background-color:var(--ion-color-primary)\\\">\\n      <img [src]=\\\"getImagen(item.avatar)\\\" style=\\\"margin:auto;width:100px\\\">\\n    </ion-avatar>\\n    <ion-label>\\n      <h3>#{{(i+1)}}\\n        {{item.nombre}}</h3>\\n      <h4>{{item.total}} {{\\\"points\\\" | translate}}</h4>\\n    </ion-label>\\n  </ion-item>\\n\\n  <ion-infinite-scroll #infiniteScroll threshold=\\\"10px\\\" (ionInfinite)=\\\"updateRanking($event,false)\\\">\\n    <ion-infinite-scroll-content loadingSpinner=\\\"null\\\" loadingText=\\\"\\\">\\n      <img src=\\\"../../../assets/imgs/loading.svg\\\" style=\\\"width:48px !important;margin:auto;position:relative\\\">\\n    </ion-infinite-scroll-content>\\n  </ion-infinite-scroll>\\n</ion-content>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3VzdWFyaW8vdS1yYW5raW5nL3UtcmFua2luZy5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { CustomLoadingModule } from 'src/app/customModules/custom-loading/custom-loading.module';\nimport { CloudService } from 'src/app/servicios/cloud.service';\nimport { IonInfiniteScroll } from '@ionic/angular';\nimport { environment } from 'src/environments/environment.prod';\nimport { DomSanitizer } from '@angular/platform-browser';\n\n@Component({\n  selector: 'app-u-ranking',\n  templateUrl: './u-ranking.page.html',\n  styleUrls: ['./u-ranking.page.scss'],\n})\nexport class URankingPage implements OnInit {\n\n  listadoRanking: any = [];  //lista de usuarios del ranking\n  urlFirst = null;  //url del avatar del primero\n  urlSecond = null;  //url del avatar del segundo\n  urlThird = null;   //url del avatar del tercero\n\n  //referencia al elemento ion-infinite-scroll\n  @ViewChild('infiniteScroll') ionInfiniteScroll: IonInfiniteScroll;\n\n  constructor(private route: ActivatedRoute,\n    private loading: CustomLoadingModule,\n    private cloud: CloudService,\n    private sanatizer: DomSanitizer) { }\n\n  ngOnInit() {\n    /*Solo cargo el ranking la primera vez que se carga la vista, si se visitan otras\n    pestañas y se vuelve no se carga para aumentar la fluidez de la aplicación.\n    Si se quiere refrescar se debe deslizar la vista hacia abajo (refresher)*/\n    this.updateRanking(null, true);\n  }\n  ionViewWillEnter() {\n    /* No queremos hacer nada cada vez que se carga la vista*/\n  }\n\n  /*\n  Carga asíncronamente la lista de usuarios en la variable listadoRanking por orden de puntos totales,\n  para ello se debe crear un índice en firebase. Si el índice no se crea da error por consola indicando\n  los pasos para crearlo y poder ordenar.\n  Si recibe una variable event es que ha sido llamado desde el refresher o el infiniteScroll, si no\n  la recibe ha sido llamada por la carga inicial de la página.\n  Si recibe la variable reload es que debes limpiar la lista y cargar desde el principio, si no\n  la recibe es porque es llamado desde infiniteScroll para añadir elementos al final de la lista\n   */\n  updateRanking(event?, reload?) {\n    if (!event)\n      this.loading.show(\"\");  //si es carga por visita activamos loading principal\n\n    this.cloud.getRanking(reload).then(d => {\n      if (reload) {\n        this.listadoRanking = d;  //carga completa\n      } else {\n        d.forEach((u) => {\n          this.listadoRanking.push(u); //añadimos al final\n        });\n      }\n      if (!event)\n        this.loading.hide();\n      if (event) {\n        event.target.complete();\n      }\n      if (this.listadoRanking[0])\n        this.urlFirst = this.listadoRanking[0].avatar;\n      if (this.listadoRanking[1])\n        this.urlSecond = this.listadoRanking[1].avatar;\n      if (this.listadoRanking[2])\n        this.urlThird = this.listadoRanking[2].avatar;\n      \n       /*Comprobamos si hay más elementos a cargar o no. En caso afirmativo no desactivamos\n       el infiniteScroll*/\n      this.ionInfiniteScroll.disabled = !this.cloud.isRInfinityScrollEnabled();\n    });\n  }\n  /* Este método transforma el código en base64 de la imagen en seguro para poder \n  inyectarlo en el campo src de la imagen, en caso contrario dará error de seguridad*/\n  getImagen(img) {\n    if (img != environment.defaultAvatar)\n      return this.sanatizer.bypassSecurityTrustUrl(img);\n    else\n      return img;\n  }\n\n}\n"],"sourceRoot":""}